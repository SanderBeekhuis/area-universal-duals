\input{preamble}

%invariant enviroment
\newenvironment{invariants}{%
  \refstepcounter{thrm}%
  \paragraph{Invariants~\theprop}%
  \renewcommand*{\theenumi}{\theprop\,(I\arabic{enumi})}%
  \renewcommand*{\labelenumi}{(I\arabic{enumi})}%
  \enumerate
}{%
  \endenumerate
}





\begin{document}
\maketitle

\section{Types of triangulations and their properties}

All graphs are presumed simple and have a fixed planar embedding

The \emph{degree} of a face is the number of vertices it is incident to. By a \emph{cycle} we will mean a simple cycle. That is a cycle without repetition of edges or vertices. By Jordan's curve theorhem a cycle splits the plane into two parts, one bounded and one unbounded. %TODO cite 
We will call the bounded part the \emph{interior} of this cycle and the unbounded part the \emph{exterior} of this cycle.

We will call a cycle \emph{seperating} if there are vertices in both it's interior and exterior. We will use \emph{$k$-cycle} to denote a cycle of length $k$. Moreover a \emph{triangle} is simply a cycle of length $3$ (i.e. a $3$-cycle). graphname


\subsection{Plane triangulations}

\begin{defi} [Plane triangulation]
A graph with only faces of degree $3$.
\end{defi}


\begin{defi} [Maximal planar graph]
A graph such that adding any one edge leaves it non-planar.
\end{defi}

\begin{thrm}
Any graph $G$ is a plane triangulation \ifftext it is maximal planar
\end{thrm}

\begin{proof}
We will prove the equivalence of the negations.

Suppose that $G$ is not maximally planar. Then there is a face $F$ to which we can add an edge, however this face must then have degree larger then $4$. Hence $G$ is also not a plane triangulation. 

Suppose that $G$ is not a plane triangulation. Then there must be a face $F$ of degree larger then $3$. This face will thus admit an extra edge without violating planarity and hence $G$ is not maximally planar.
\end{proof}

\subsubsection{Connectedness}
\begin{thrm}
Any plane triangulation $T$ is $3$-connected.
\label{th:plTri3Connected}
\end{thrm}

\begin{proof}
Suppose that $T$ is not $3$-connected. Then there must be a $2$-cutset $S$, given by the vertices $x$ and $y$. Removing this cutset splits the graph into at least two connected components $C_i$ and all components are incident to all cutvertices otherwise we would have found a $1$-cutset.

Since $S$ is a cutset, there can't be any edges incident to both $C_1$ and $C_2$. But then the edge $xy$ should be separating the $2$ components on both sides. This is impossible since we can only draw this edge once. %TODO figure/ and clarify
\end{proof}

\begin{defi}[Irreducible triangulation]
We call a triangulation irreducible if it has no separating triangles
\end{defi}

%TODO show reduction?

\begin{thrm}
Any irreducible plane triangulation $T$ is $4$-connected.
\end{thrm}

\begin{proof}
Note that any plane triangulation is $3$-connected by Theorhem \ref{th:plTri3Connected}.

Suppose that $T$ is not $4$-connected. Then there must be some $3$-cutset (since it is $3$-connected) let us denote the vertices of this cutset by $x, y$ and $z$. Removing this cutset splits the graph into at least two connected components $C_i$ and all components are incident to all cutvertices otherwise we would have found a $2$- or $1$-cutset.  

However, now $xy$ must be an edge in the triangulation $T$ otherwise the graph is not maximal planar (There can't be an edge incident to both $C_1$ and $C_2$ because that would negate $x, y ,z$ being a cutset.). In the same way $yz$ and $xz$ are edges of $T$. But then $xyz$ is a separating triangle. This is an contradiction and thus $T$ is $4$-connected
\end{proof}

\subsection{Triangulations of the $k$-gon}

\begin{defi}[Triangulation of the $k$-gon]
We call a graph a triangulation of the $k$-gon if the outer face has degree $k$ and all interior faces have degree $3$.
\end{defi}
Vertices bordering the outer face are \emph{outer vertices} while all other vertices are \emph{interior vertices}. Furthermore the cycle formed by all vertices outer vertices is the \emph{outer cycle}.

Sometimes such triangulations of the $k$-gon are called \emph{(plane) triangulated graphs}.


\begin{defi}[Irreducible triangulation of the $k$-gon]
We call a triangulation of the $k$-gon irreducible if it has no separating triangles.
\end{defi}


Note that triangulation of the $n$-gon $n\geq 4$ is not maximally planar and thus not plane triangulation.

\begin{comment}
%Don't know yet if this a usfull construct
\begin{thrm}
The interior of a triangulation of the $n$-gon is maximally planar. That is to say, we can't add any edges except trough the outer face.
\end{thrm}

\begin{proof}
Suppose the 
%TODO (not max plan. => face of degree 4
\end{proof}
\end{comment}

The \emph{completion} of a triangulation of the $k$-gon $G = (V, E)$. Is the graph $G'= (V', E')$ with vertex set $V' = V \cup \braces{s}$ and edge set $E' = E \cup \braces{ sv | v \text{ is a outer vertex}}$ 

The completion is plane triangulation.  %Q does this stament need proof? 
Since the interior of the outer cycle of $G$ always consisted of faces of degree 3. The exterior of the outer cycle consisted of one face of degree $k$ (the outer face) but the completion has turned this into $k$ faces of degree $3$.  

\begin{thrm}
A triangulation of the $k$-gon $G$ is $2$-connected.
\end{thrm}
\begin{proof}
Suppose that $G$ has a cutvertex $v$. Then the set $\braces{s, v}$ is a $2$-cutset of the completion $G'$ of $G$. This however is in contradiction to Theorem \ref{th:plTri3Connected} stating that $G'$ is $3$-connected. Hence $G$ has no cutvertex and is thus $2$-connected.
\end{proof}

\begin{thrm}
\label{th:irreducible and chordless triangulation of the kgon is 3connected}
A irreducible and chordless triangulation of the $k$-gon is $3$-connected.
\end{thrm}
\begin{proof}
\note Will be provided if this statement turns out to be interesting. Will go via the fact that the completion is a irreducible triangulation. Chordless outer cycle is important, because a chord will form a separating triangle in $G'$.
\end{proof}

\begin{thrm}
Any irreducible triangulation $T$ of the $4$-gon with $n \geq 5$ is $3$-connected. 
\end{thrm}

\note This proof could be a corrolary of the above theorhem \ref{th:irreducible and chordless triangulation of the kgon is 3connected}. A chord gives a separating triangle if $n\geq 5$.
\begin{proof} 
Let us name the four outer vertices $a,b,c,d$ in clockwise order. Let us first note that the diagonals $ac$ and $bd$ can't be an edge since this would create a separating triangle containing the $5$th vertex. Let $I$ denote the component of all interior vertices, since every face in the interior is of degree $3$ each outer vertices is incident to at least one edge that is also incident to $I$. %TODO figure

One can now easily check that there is no $2$cut set with only exterior vertices. However, a cutset with $1$ or $2$ interior vertices leads to at least one cycle of degree greater then $3$ %TODO expand/ figure.

Hence no $2$-cutset of $T$ can't exist and $T$ is $3$-connected. 
\end{proof}

\begin{thrm}
For every interior vertex $v$ of a triangulation of the $k$-gon $G$ is connected by ate least $3$ vertex disjoint paths to different outer vertices.
\end{thrm}
\begin{proof}
By Theorhem \ref{th:plTri3Connected} the completion $G'$ of $G$ is $3$-connected. Hence there are 3 vertex-disjoint paths from $v$ to $s$. Since $v$ is on the interior and $s$ is on the exterior of the outer cycle $\C$ all these 3 paths cross the outer cycle at least once. These paths cross $\C$ for the first time in different vertices since they are vertex-disjoint. If we shorten the paths to their first crossing with $\C$ we obtain the $3$ paths in the theorem.
\end{proof}

\note We can sharpen this to $4$ if we have a irreducible an chordless triangulation of the $k$-gon

\begin{thrm} 
Every interior vertex of a triangulation of the $n$-gon has degree at least $3$.
\end{thrm}
\begin{proof}
Suppose a interior vertex $v$ has degree $1$ then clearly the face surrounding $v$ can't have degree $3$. Now suppose that an interior vertex $v$ has degree $2$. We then let $u$ and $w$ denote it's neighbours and $F$ and $F'$ the face incident to $v$. See also Figure \ref{fig:interiorVertexDegree3}. Then since $F$ and $F'$ are both interior faces they need to be off degree $3$ this implies that $uw$ is an edge for both faces. This is impossible and hence every interior vertex has at least degree $3$
\end{proof}

\begin{figure}[h!]
\centering
\includegraphics{img/interiorVertexDegree3.pdf}
\caption{The notation as described in the proof \label{fig:interiorVertexDegree3}
}
\end{figure}

\note If we forbid irreducible triangulations every interior vertex is of degree $4$ since the neighbourhood of any internal vertex $v$ looks like a set of triangles.

\note This theorem is currently (17-09) unused.




\section{Rectangular duals}

\newcommand{\G}{\scr G}
\renewcommand{\L}{\scr L}

In this section we will explain what we mean with the rectangualr dual of a graph. We will prove some simple properties of graphs and their duals.

We define a \emph{rectangular layout} (or simply \emph{layout}) $\L$ to be a partition of a rectangle into finitely many interiorly disjoint rectangles. 

We will assume that no four rectangles meet in one point.

We will then look at the \emph{dual graph of a layout} $\L$ and denote this graph by $\G(\L)$. That is, we represent each rectangle by a vertex and we connect two vertices by an edge exactly when their rectangles are adjacent. Note that this graph is not the same as the \emph{graph dual} of $\L$ when we view it as a graph (namely we don't represent the outer face of $\L$ by a vertex).

So $\G(\L)$ is the dual graph of a layout $\L$. In the reverse direction we say a layout $\L$ is a \emph{rectangular dual} of a graph $\G$ if we have that $\G = \G (\L)$.

A plane triangulated graph $\G$ does not necessarily have a rectangular dual nor is this dual necessarily unique.
%TODO in what sense not unique
%TODO provide examples

%TODO weave a corner assignment in here somewhere

\subsection{Extended graphs}
A \emph{extended graph} $\ext G$ of $G$ is a augmentation of $G$ with $4$  vertices (which we will call it's \emph{poles}). Such that 
\begin{enumerate}
\item every interior face has degree $3$ and the exterior face has degree $4$.
\item all poles are incident to the outer face
\item $\ext\G$ has no separating triangles (i.e separating $3$-cycles).
\end{enumerate}.

We sometimes call an extended graph $\ext G$ of $G$ an \emph{extension} of $G$.

Such a extended graph does not necessarily exist and is not necessarily unique.  %TODO show this
However we have the following result due to .... %TODO cite

\begin{thrm}[Existence of a rectangular dual]
A plane triangulated graph $\G$ has a rectangular dual \ifftext it has an extension $\ext \G$
\end{thrm}

\begin{proof}
Kozminski \& kinnen and ungar, See siAM paper %TODO check this
\end{proof}

We call any (plane triangulated) graph $G$ that has an extension a \emph{proper} graph.

A proper graph $G$ can have more then one extensions. Each such extension fixes which of the rectangles are in the corners of the rectangular dual $\L$. Hence sometimes such an extension is called a \emph{corner assignment}.


\subsection{Regular edge labeling}
A regular edge labelling  of $\ext G$ corresponds to a rectangular dual $\L$ of $G$ with some \emph{corner assignment} fixed. %TODO KANT HE
%explain equivalence

Or regular edge labelling of a graph.


An \emph{interior edge} of a cycle is an edge on the interior of the cycle (when the cycle is viewed as Jordan curve).


\subsubsection{Being onesided in terms of REL}

\subsubsection{Being psudeo-onesided in terms of REL}

\section{Fixing a extension}
In our explorations to find a lower bound on what kind of \emph{psuedo one-sidedness} is possible we will find it very useful to fix one particular extension $\ext G$ of $G$. Unfortunately if there is no rectangular dual thatâ€™s $(k,l)$-sided using the \emph{corner assignment} provided by some extension $\ext G$. This does not imply that $G$ is not $(k,l)$-sided. There might be another extension of $G$ such that under the corner assignment corresponding to this extension $G$ has a $(k,l)$-sided rectangular dual. 

Fortunately for us however we can view $\ext G = H$ as a graph in it's own right, then $G$ is the interior of a separating $4$-cycle of $H$ and we will show this implies that $G$ (as induced sugraph) has to be coloured according to the extension $\ext G$. 

\begin{remark}
\label{re:interiorRectangle}
Let $\C$ be a separating $4$-cyle of $G$ with interior $I$. Then in any rectangular dual of $G$ the region enclosed by the rectangles dual to the vertices in $\C$ is a rectangle.
\end{remark}

\begin{remark}
\label{re:disjointRectanglesOnlyHaveOneAdjecentSide}
Two disjoint rectangles are at most adjacent on one side.
\end{remark}

\begin{lemma}
\label{lem:fourCycleUnicolor}
Let $\C = \braces{a, b, c, d}$ be a separating $4$-cyle of $\ext G$ with interior $I$. Then all interior edges incident to $a, b, c$ and $d$ respectively are red, blue, red and blue or blue, red, blue and red.
\end{lemma}

\begin{proof}
%from page 4
%We could also try a reduction along the lines of min. seperation componenets Epstein et. al
By Remark \ref{re:interiorRectangle} the union of the rectangles in the interior of $\C$ will be some rectangle in any rectangular dual. We will denote this rectangle by $I$. Since two disjoint rectangles can only be adjacent to each other at one side all interior edges incident to any vertex of $\C$ are of the same color. 

Furthermore $a, b, c, d$ are all adjacent to a different side of $I$ since $I$ has four sides that need to be covered and it is only adjacent to four rectangles. If we then apply the rules of a regular edge labelling we see that if the interior edges of $a$ are one color, those incident to $b$ and $d$ should have the second color. Then of course the interior edges incident to $c$ are again coloured with the first color. 

\end{proof}

This lemma implies that any \emph{alternating 4-cycle} %TODO define
is either \emph{left-alternating} or \emph{right-alternating} %TODO define
in the terminology of \Fusy

Furthermore the above Lemma is also very useful in that it allows us to fix a extension $\ext G$ of $G$ by building a \emph{scaffold}. Suppose we want to investigate some extension $\ext G$ of $G$ with poles $N$, $E$, $S$ and $W$ then we can consider the graph $\ext G = H$ as a graph in it's own right. $H$ is a proper graph since it has no irreducible triangles in it's interior (because $\ext G$ had none) and it admits a valid extension $\ext H$ by connecting the new poles $NE, SE, SW$ and $NW$ to $N, E, SE, NW$, $S, E, NE, SW$, $S, W, SE, NW$ and $N, W, NE, SW$ respectively. See Figure \ref{fig:scafold} for this extension.  
\fxnote{Maybe use a table}

\begin{thrm}
\label{th:fixExtension}
We can fix an extension, if we want.
\end{thrm}

\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{img/scafold}

\caption{The construction of a scaffold. $G$ is displayed in thick lines and with closed vertices. An arbitrary extension $\ext G =H$ is then drawn with thin lines and open vertices. An extension of $H$ is then drawn with dashed edges and open vertices. 
    \label{fig:scafold}}
\end{figure}

The graph $H$ can have more then one extension but they all contain the separating $4$-cycle $\C= NESW$ thus by Lemma \ref{lem:fourCycleUnicolor} we see that, without loss of generality, the interior edges of $\C$ incident to $N$ and $S$ are coloured red and those incident to $E$ or $W$ are coloured blue. This is exactly as if we forced the extension $\ext G$

\subsection{An aplication: There are graphs that are $(2, \infty)$-sided}

We will show this by providing an example graph $G$ with a fixed extension $\ext G$ which we can do according to Theorem \ref{th:fixExtension}. Consider the graph in Figure \ref{fig:2manysidedLowerBound}. Note that most of the interior vertices are of degree $4$ and thus the largest part of any regular edge labelling is forced. Those edges that are forced to have a certain color are already coloured in Figure \ref{fig:2manysidedLowerBound}.


\begin{figure}[h!]
\centering
\includegraphics[scale=.5]{img/2manysidedLowerBound}

\caption{The fixed extension $\ext G$
    \label{fig:2manysidedLowerBound}}
\end{figure}

The only edge for which we have freedom to choose a color is the diagonal edge of $G$. Howeever, if we color this edge blue we get a red $(2, \infty)$ cycle and if we color this edge red we get a blue $(2, \infty)$ cycle. In both cases we will thus obtain a $(2,\infty)$-sided segment in our dual.


\section{Algorithms}
All algorithms so far will have the same core but will differ in which eligible paths they pick.    

\renewcommand{\P}{\scr{P}}


The algorithm will always maintain the following three invariants

\begin{invariants}
  \itemsep=-4pt

\item \label{i:1} The cycle $\C$ contains the two edges $S_rS_b$ and $S_rN_b$.
\item \label{i:2}No edge in the interior of $\C$ connects two vertices in $\C\setminus{S_r}$
\item \label{i:last} All inner edges of $T$ outside of $\C$ are colored and oriented in such that the innnervertex condition holds. %TODO what is the inner vertex condition
\end{invariants}

A cycle satisfying these three invariants will have the same general shape as in figure \ref{fig:invCycle}. We note that the cycle has at least $4$ vertices because otherwise a seperating triangle is created. 

\begin{figure}[h!]
\centering
\includegraphics{img/algo/invCycle}

\caption{An example of a cycle $\C$ satisfying the invariants 
    \label{fig:invCycle}}
\end{figure}

It is also nice to note that the union of the cycle and it's interior form a triangulation of the $n$-gon since it is a induced subgraph of a triangulation of the $4$-gon.

If we remove $S_r$ from $\C$ we are left with a path from $N_b$ to $S_b$. We can then order nodes of the path by their distance (over the path)  to $S_b$. Thus $N_b$ is maximal while $S_R$ is minimal. For any two vertices $v > v'$ in this path we will denote by $[v, v']$ the subpath from $v$ to $v'$.

\subsection{Eligible paths}

\begin{defi}[internal path]
We call a path $\P$ an internal path of $\C$ if  all its edges are in the interior of $C$ and it connects two distinct vertices of $\C$ 
\end{defi}

%TODO define \C_\P

\begin{defi}[eligible path]
We call an internal path $\P$ from $v$ to $v'$ eligible if 
\begin{enumerate}
 \renewcommand*{\labelenumi}{(E\arabic{enumi})}%
 \renewcommand*{\theenumi}{(E\arabic{enumi})}%


\item Neither $v$ or $v'$ is $S_r$ \label{e:notSr}
\item The paths $\P$ and $[v,v']$ both have at least 3 vertices \footnote{i.e. both have an interior vertex} \label{e:internalVertices}
\item Each edge in the interior to $\C_\P$ connects a vertex of $\P\setminus{v,v'}$ and $[v,v']\setminus{v,v'}$. In particular $\C_\P$ is a non-separating cycle.
\label{e:crossingedge}
\item The cycle $\C'$ obtained by replacing $[v,v']$ by $\P$ in $\C$ has no interior edge connecting the two vertices of $C\setminus{S_r}$.
\label{e:noChordinC'}
\end{enumerate}
\end{defi}

\begin{remark}
``Shrinking'' the cycle with an eligible path will keep all the invariants true.
\end{remark}

We will show the following proposition.

\begin{thrm}[Existence of a eligible path]
\label{th:eligExistence}
When the algorithm's invariant (\ref{i:1} - \ref{i:last}) are satisfied and the cycle $\C$ is separating then there exist a \emph{eligible} internal path.
\end{thrm}

\begin{proof}
We will first show that there always exists an internal path $\P$. We will then show that a internal path can be found that satisfies conditions $(E1) - (E4)$.

In the proof we will often use that a 

Let us first note that if the cycle $C$ is separating (i.e has a non-empty interior), there is at least one interior vertex $v$. Since the triangulation of a $n$-gon is $2$-connected there are two ways to go from $v$ to (say) $S_r$. Hence there is an internal path $\P_0$.
%TODO this is not true, luckily we can use the connections to cyle lemma

If this path does not satisfy \ref{e:notSr} we can use the following construction. The other vertex where $P_0$ intersects $\C$ is not $S_r$. Let us call this vertex $x$ and it's neighbour on the path $y$. The vertex $x$ might be $N_b$ or $S_b$ but can't be both, hence it has at least one neighbour $z$ on the cycle that is not $S_r$. Because the triangulation of a $n$-gon is internally maximally planar we have that $yz$ is an edge. Now $xyz$ is an internal path satisfying \ref{e:notSr}. See also figure \ref{fig:E1}, here we made a choice on which side of $y$ the vertex $z$ lies, but this choice can be made without losing generality.

Hence we have now constructed, or already had, a path that satisfies \ref{e:notSr}. Let us for the remainder of the proof denote this path by $\P_1$.


\begin{figure}[h!]
\centering
\includegraphics[]{img/algo/E1}
\caption{Constructing a path satisfying \ref{e:notSr} \label{fig:E1}}
\end{figure}

\paragraph{There is a path that also satsifies (E2)}
If $\P_1$ satisfies (E2) we set $\P_2 = \P_1$ otherwise we will create a path that satisfies (E1) and (E2). 
If the path $\P_1$ does not satisfy $(E2)$ \footnote{which will be the case if the above construction has been used} then there are two possibilities  a) $\P_1$ does not have interior vertices and/or b) $[v,v']$ does not have interior vertices. If a) would be true the existence of $P_0$ would contradict Invariant \ref{i:2}. Hence the only problem can be that $b)$ occurs. 

If $v=N_b$ and $v'=S_b$ we have found a separating triangle given by $S_rN_bS_b$ \footnote{this is the cycle $\C$ which is separating} in original graph. Hence at least one of $v$ or $v'$ is not $N_b$ or $S_b$. If we call this vertex $x$ its neighbour on the path $y$ and it's neighbour outside $[v,v']$ $z$. We see that by the interior of $\C$ being maximally planar $yz$ must be an edge. If we now adapt $P_1$ by replacing $yx$ by $yz$ we have made $[v,v']$ one vertex longer and hence created a path satisfying \ref{e:length2borders}. In figure \ref{fig:E2} we show this procedure in two cases. Executing this procedure does not change that $S_r$ is not one of the endpoints of the path. Hence we have now created a path $\P_2$ that satisfies \ref{e:notSr} and \ref{e:length2borders}.

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{img/algo/E2general}
        \caption{The general case. Note that $x=v'$.}
    \end{subfigure}
    ~ 
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{img/algo/E2spec}
        \caption{A specific case. Note now that $N_b=v, v'=x$ and $S_b=z$}
    \end{subfigure}

    \caption{Creating a path satisfying \ref{e:length2borders}. The dotted line is the edge we take in the new path $\P_2$}\label{fig:E2}
\end{figure}

\newcommand{\intvv}{\ensuremath{[v,v']\setminus{v,v'}}}
\newcommand{\intP}{\ensuremath{\P\setminus{v,v'}}}

\paragraph{There is a path that also satisfies (E3)}
If $\P_2$ satisfies $(E3)$, we take $\P_3 = \P_2$. Otherwise we will remedy the defect. We separate five different cases of offending edges. All of the five cases will be easy to remedy giving a path $\P'_2$ still satisfying \ref{e:notSr} and \ref{e:length2borders} such that $\C_{\P'_2}$ is strictly contained in $\C_{\P_2}$ %Q what is the right version of smaller here?
\begin{enumerate}
 \renewcommand*{\labelenumi}{\alph{enumi})}%
 \renewcommand*{\theenumi}{\alph{enumi})}%
 \item edges from \intvv to $\intvv$
 \item edges from $\intP$ to $\intP$
 \item edges incident to $v$ or $v$ and some other vertex on $\C_{\P_2}$
 \item edges from $[v,v']$ to some internal vertex 
 \item edges from $\intP$ to some internal vertex
\end{enumerate}

The existence of an edge as in a) is forbidden by Invariant \ref{i:2}. If b) occurs we can simply shortcut our original path $\P_2$ with this edge. If c) occurs this edge can't go to another vertex in $[v,v']$ since that would offend Invariant \ref{i:2}. Hence they go to a vertex in $\P_2$ and we can shortcut the path as in b).

If d) occurs we simply make a new path and if e) occurs we take a slightly adapted interior path. See figures

%TODO pictures

Since all of the moves shrink $\C_{\P_2}$ while keeping \ref{e:notSr} and \ref{e:length2borders} intact and we can't infinitely shrink this means at a certain point no more moves are available. Since every offending edges allows a move this means that there are no more offending edges. Hence this version of $\P'_2$ satisfies \ref{e:crossingedge}. For the final step of the proof we take $\P_3 = \P'_2$.

%TODO formulate repetition argument nicly

\paragraph{There is a path that also satisfies \ref{e:noChordinC'}}
Suppose that $\P_3$ does not satisfy \ref{e:noChordinC'}. Then we can just take the would be interior edge and take this for a nwe path. This is again a finite procedure reducing the sum of $|\P_3| -|[v,v']|$. In the end we have a path satisfying \ref{e:notSr} - \ref{e:noChordinC'}.

%TODO picturse, why dont we lose E1-E3


\end{proof}

\subsection{Minimum distributive lattice element}
We get this when we take the    ``leftmost'' eligible path. 

\renewcommand{\F}{\scr F}
\subsection{Horizontal one-sides}
\note we should define the border of a face of a bipolar orientation somewhere. 
\note and what we mean with \emph{cycle border} and \emph{face border}
\note as well as the notation of $\F_\P$ the face of a path

As an exercise one could try to addapt Fusy's algorithm to generate horizontally one-sided layouts directly, without doing flips in the distributive lattice. It turns out that this is not that diffcult.

Since the horizontal segments correspond to face in the blue bipolar orientation we want that one of the two borders of the face has a length of at most two. Since every eligible path we take splits off one face in the blue bipoolar orientation it is easy to control this property.

\begin{thrm}
\label{th:blueelig}
In the update of the algorithm there is always an eligible path $\P$ available such that either $\P$ or $[v,v']$ is of length $2$. 
\end{thrm}

In order to proof this theorhem we will first show the following lemma.

\begin{lemma}
\label{lem:bluealgo}
If $\P$ is an eligble path giving raise to a face $\F_P$ of which both border have length at least $3$. Then there exist an eligible path $\P'$ such that the pathborder and cycleborder of its face $\F_{\P'}$ are both at least $1$ shorter than those of $\F_\P$.
\end{lemma}

\begin{proof}
In this proof we will frequently use property \ref{e:crossingedge} of a Eligible path, we won't mention it every time we use it.

We denote the source by $s$ and the sink by $t$. We also assign names$a, b$ and $x, y$ to the first two vertices on both borders, see Figure \ref{bluefig:notation}. Since every interior face of $G$ is a triangle $ax$ is an edge. Now we distinguis two cases, either $ay$ is an edge (case 1) or $bx$ is an edge (case 2). Tey can't both be an edge at the same time due to planarity, neither can it happen that both of them are not an edge since then the face containing the path $baxy$ is at least of degree $4$.

In the first case $a$ may be connected to more vertices on the pathborder, however there is a last one, say $z$. And this vertex is then also connected to $b$, otherwise it would not be the last one. Now we can provide an shorther eligible path $\P'$ we start at $a$ go to $z$ and from there we follow the old path $\P$ to $t$.  See figure \ref{bluefig:case1}. It is easy to see that all four properties of an eligible path hold for $\P'$.
\begin{comment}
By construction $\P'$ satifies \ref{e:notSr} and \ref{e:internalVertices}. While the interior of $\C_{\P'}$ is a subset of that $\C_\P$%TODO this is again an eligible path
\end{comment}

In the second case $x$ may be connected to more vertices along the cycle border, however there is a last one, say $c$. And this vertex is then also connected to $y$, otherwise it would not be the last one. Now we can provide an shorther eligible path $\P' = sxz$.   See figure \ref{bluefig:case2}. It is straightforward to see that all four properties of an eligible path hold for $\P'$. %TODO this is again an eligible path
\end{proof}

\begin{figure}[h]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{img/algo/blue/setting}
        \caption{The setting}
        \label{bluefig:notation}
    \end{subfigure}
    
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{img/algo/blue/case1}
        \caption{Case 1}
        \label{bluefig:case1}
    \end{subfigure}
    ~
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{img/algo/blue/case2}
        \caption{Case 2}
        \label{bluefig:case2}
    \end{subfigure}

    	\caption{}
	\label{fig:E2}
\end{figure}

\begin{proof}[Proof of Theorem \ref{th:blueelig}]
By Theorem \ref{th:eligExistence} we know there is a eligible path $\P$. If one of the borders of $\F_\P$ is of length $2$ or less we are done. If this path gives raise to a face $\F_\P$ with both borders are both of length at least $3$ we can repeatedly apply Lemma \ref{lem:bluealgo} until at least one of the borders is of length at most $2$. 
\end{proof}

If we in every update of the algorithm take the paths from Theorem  \ref{th:blueelig} we end up with the correct faces in the blue bipolar orientation and hence a horizontally one sided rectangular dual.

\subsection{Vertical one-sided}

We can also adapt Fusy's algorithm to generate a vertically one-sided dual. We do this by picking the eligible path with the leftmost starting point and letting it run for as long as possible. In the final oriented regular edge labelling we want to prevent red faces that have $3$ or more edges on both borders. 

If a red face has 
\begin{lemma}
A face $F$ with at least $3$ edges on each side contains a $Z$ 
\end{lemma}

But a $z$ can only be the result of a seqeuncce of eligble paths that does not satisfy the requirements. 



\end{document}
