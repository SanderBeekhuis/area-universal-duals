%!TEX root = ../thesis.tex
\renewcommand{\Q}{\scr Q}


We will assume the entire graph has no separating 3 or 4 cycles. We will show that in this case ...



\section{Algorithm}
  The algorithm will consist of two phases

  \begin{enumerate}
    \item Find a \emph{vertically} 1-sided layout with additional properties
    \item Do additional post-processing steps to make this layout $k$-sided.
  \end{enumerate}

\subsection{Phase 1}
  In Phase 1 we execute a sweepcycle algorithm comparable to Fusy's \cite{Fusy2006}.
  During the algorithm we will want to maintain several invariants. The first three are equivalent to those imposed by Fusy. The final two invariants are new and impose a nice structure on the sweepcycle so far.

  \begin{invariants}
    \itemsep=-4pt

    \item \label{i:uni:SWandSE} The cycle $\C$ contains the two edges $\pS \pW$ and $\pS \pE$.
    \item \label{i:uni:noChords} $\cpath$ has no chords
    \item \label{i:uni:intVertCond} All inner edges of $T$ outside of $\C$ are colored and oriented in such that the inner vertex condition holds. %TODO what is the inner vertex condition
    \fxerror{We need to add a partial inner vertex condition}
    \item \label{i:uni:no2Chords} $\C\sm{\pW, \pS, \pE}$ has no separating 2-chords
  \end{invariants}


  \begin{defi}[Prefence]
  A prefence $\W$ is a interior path of $\C$ starting at $v_i \in \C$ and ending at $v_j \in \C$ a both adjacent to $\pS$
  \begin{enumerate}
    \itemsep=-4pt
    \renewcommand*{\labelenumi}{(P\arabic{enumi})}%
    \renewcommand*{\theenumi}{(P\arabic{enumi})}%

    \item  $\C_\W$ Has no interior vertex
    \label{p:noInteriorVertex}
    \item  $\W$ has no chords on the left     \label{p:Wchordfree}
    \item  $\restC{\W}$ has no chords on the right     \label{p:Cchordfree}
  \end{enumerate}
  \end{defi}

  We do the following
  \begin{enumerate}
    \itemsep=-4pt
    \item Find the right neighbor walk
    \item Evade any future irregularities
    \item Update with this valid path
  \end{enumerate}

  We then repeat this until the sweepcycle does not contain any more interior vertices.

  \paragraph{Find the right neighbor path}
    Let $v_i$ denote all the vertices of $\cpath$ in the following order $\pW =  v_1 \  v_2 \  \ldots v_{n-1} \  v_n = \pE$.
    Some intervals of these vertices will be adjacent to $\pS$. However, they can't be all adjacent to $S$ since then the sweepcycle would be non-separating since we assumed $G$ has no separating triangles. We denote by $v_i$ the last vertex of fist interval of vertices adjacent to $S$ and by $v_j$ the first vertex of the second interval.
    As candidate walk we will take the right neighbor path of $\braces{v_i, \ldots, v_j}$.

    \begin{lemma}
      \label{lm:uni:isPrefence}
    The collection $W$ described above is a prefence.
    \end{lemma}
    \begin{proof}
    $W$ is a walk by lemma \ref{lm:uni:neighborWalk}. Furthermore it is a path since any non-simple point would offend Invariant \ref{i:uni:no2Chords} of the sweepcycle.


    We note \ref{p:noInteriorVertex} holds due to Lemma \ref{lm:uni:neighbourwalkNoInteriorVertex}

    We note \ref{p:Wchordfree} holds due to Lemma \ref{lm:uni:neighbourwalkChordFree}.

    We note \ref{p:Cchordfree} holds due to invariant \ref{i:uni:noChords}.
    \end{proof}

    We then orient $\W$ from $v_i$ (the vertex closest to $\pW$)to $v_j$ (the vertex closest to $\pE$) and denote it's vertices by $w_1 \ldots w_k$.


    \subsubsection{Irregularities}
      \fxerror{Account for polebound 2-chords}
      Now the prefence we found can have several structures we want to avoid
      namely
      \begin{enumerate}
        \itemsep=-4pt
        \item Chords
        \item Separating 2-chords
      \end{enumerate}

      All of these structures are on the right of the prefence since the prefence satisfies \ref{p:Wchordfree} (no chords on the left) and \ref{p:noInteriorVertex} (no separating 2-chords on the left).

      What we do depends on the first obstacle we encounter. The \emph{range} of an obstacle will be given by it's start and end vertex.

      \fxwarning{TODO Rewrite this to be clear}
      \paragraph{First obstacle is a chord}
      If our precycle has any chords we look identify the them by their start and end vertex. Of the chords with the lowest start index we will consider the one with the largest end index.

      Now we have a group of chords with start and end vertices. What we do now depends on whether a 2-chord shows up.

      \emph{No 2-chord}
      We look at the chord with the smallest range (i.e. highest start $i_0$ and lowest end $j_0$) then we will look at the biggest chords still starting at $i_0$ or ending at $j_0$. Say that this chord goes from $i_1$ to $j_1$ then we augment the sweepcycle with $i_1 +1$ to $j_1 -1$.

      \emph{A 2-chord}
      We find a piece to augment with in the same way  but we terminate it just before the first closing 2-chord.

      \paragraph{First obstacle is a 2-chord}
      If this 2-chord contains a chord, just apply the rules for chords as given above. Otherwise terminate the prefence just before the end of the 2-chord.

      \fxwarning{TODO Rewrite this to be clear}

      \begin{lemma}
        \label{lm:}
        We always augment with a valid path
      \end{lemma}
      \begin{proof}
        By construction
      \end{proof}

      \begin{lemma}
        \label{lm:}
        The resulting REL is vertically one-sided
      \end{lemma}
      \begin{proof}
        This is the same as saying that the resulting regular edge labeling has no blue Z's

        There are two ways a blue Z can form either we start at a vertex just before a merge or we terminate on a vertex just after a split.

        For start point the following holds. Either we start adjacent to $\pS$ or we start due to a chord.

        For end points the following holds either we end adjacent to $\pS$, or due to a chord or 2-chord.


        We will first show that we can't have a start just after a merge.
        If the merge is due to the vertex being adjacent to $\pS$ then the previous vertex is also adjacent to $\pS$ and we have nowhere to go. \fxnote{provide figure}

        Suppose now we ended due to a chord or a 2-chord. Then the only reason to start on this place is due to a chord.

        If we start or end at a vertex adjacent to $\pS$ the diagonal edge can't exist. Because there is not enough space for moves that could have generated this ... (I Think)

        \fxerror{Work this out, no energy now}
      \end{proof}
